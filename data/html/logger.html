<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Sensor de Chuva</title>
    <link rel="stylesheet" type="text/css" href="style"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0"
        type="text/css" rel="stylesheet" />
</head>

<body class="body-index">
    <div class="container container-title-log">
        <h2><span id="titleRed">FullArm</span><span id="titleBlack">Hardware</span></h2>
        <h3>Sensor de Chuva</h3>
    </div>

    <div class="flex-debug">
        <div class="container container-status">
            <h4 class="tittle-log-status">Tabela de Status</h4>
            <div class="container-log-status">
                <div class="container container-log-status-item shadow-status-ok" id="divRain">
                    <span style="font-size:50px;" class="material-symbols-outlined" id="imgStatusRain"></span>
                    <h5 id="txtStatusRain"></h5>
                </div>
                <div class="container container-log-status-item shadow-status-ok" id="divWindow">
                    <span style="font-size:50px;" class="material-symbols-outlined" id="imgStatusWindow"></span>
                    <h5 id="txtStatusWindow"></h5>
                </div>
            </div>
        </div>

        <div class="container container-logger" id="log">
            <h4 class="tittle-log-status">Log de Informações</h4>
            <div class="container-logger">
                <p class="p-logger" id="txtLogger"></p>
            </div>
        </div>
    </div>

    <p></p>

    <a href="javascript:history.back()">
        <button class="button button-out-container">Voltar para Home</button>
    </a>

    <script>
        setInterval(function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {

                    setContentElement("txtStatusRain", this.response["txtRain"]);
                    setContentElement("imgStatusRain", this.response["imgRain"]);
                    setContentElement("txtStatusWindow", this.response["txtWindow"]);
                    setContentElement("imgStatusWindow", this.response["imgWindow"]);

                    setShadow("divRain", this.response["shadowRain"]);
                    setShadow("divWindow", this.response["shadowWindow"]);
                }
            };
            xhttp.open("GET", "/info_logger", true);
            xhttp.responseType = 'json';
            xhttp.send();
        }, 1866);

        function setContentElement(id, msg){
            document.getElementById(id).textContent = msg;
        }

        function setShadow(id, classShadow){
            document.getElementById(id).classList.remove("shadow-status-rain-detected", 
                                                         "shadow-status-window-open",
                                                         "shadow-status-ok");
            document.getElementById(id).classList.add(classShadow);
        }


        setInterval(function () {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("txtLogger").innerHTML = this.response["txtLogger"];
                }
            };
            xhttp.open("GET", "/get_logger", true);
            xhttp.responseType = 'json';
            xhttp.send();
        }, 4277);


    </script>
</body>

</html>